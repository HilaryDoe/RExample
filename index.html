<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Hilary Doe, PhD">

<title>DoeRSample</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="SampleQuartoDoe_files/libs/clipboard/clipboard.min.js"></script>
<script src="SampleQuartoDoe_files/libs/quarto-html/quarto.js"></script>
<script src="SampleQuartoDoe_files/libs/quarto-html/popper.min.js"></script>
<script src="SampleQuartoDoe_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="SampleQuartoDoe_files/libs/quarto-html/anchor.min.js"></script>
<link href="SampleQuartoDoe_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="SampleQuartoDoe_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="SampleQuartoDoe_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="SampleQuartoDoe_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="SampleQuartoDoe_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="SampleQuartoDoe_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="SampleQuartoDoe_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">DoeRSample</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Hilary Doe, PhD </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="purpose" class="level1">
<h1>Purpose</h1>
<p>I created this Quarto document as an informal demonstration some of my basic knowledge and skills using R for data cleaning and analysis.</p>
</section>
<section id="quartormarkdown-use" class="level1">
<h1>Quarto/Rmarkdown Use</h1>
<p>This Quarto document was created in the “<strong>Source</strong> View” rather than relying on the “<strong>Visual</strong> View” in order to further demonstrate my coding abilities.</p>
<p>This document begins with a code-chunk in which I library the necessary packages, but with <code>include: false</code> to avoid including the code and output in the resulting document.</p>
<p>In this document I will:</p>
<ul>
<li>Import several publicly available data sets of different types and via different methods</li>
<li>Clean those data sets to create and maintain the variables I need</li>
<li>Join data sets together</li>
<li>Run some basic analysis</li>
<li>Create and use a function</li>
<li>Create some basic graphs using <code>ggplot2</code>
<ul>
<li>Box plots</li>
<li>Bar charts</li>
<li>Scatter plots with regression lines</li>
</ul></li>
</ul>
<p>I will alternate between showing all code, all code and output, and just output within the document to display my current coding style in some places and simplify the output in others.</p>
</section>
<section id="import-and-clean-data" class="level1">
<h1>Import and Clean Data</h1>
<section id="census-data" class="level2">
<h2 class="anchored" data-anchor-id="census-data">Census Data</h2>
<p>The following code chunk uses <code>echo:true</code> and <code>output: false</code> to show the code but suppress the output.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get Census Data ####</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># census_api_key("[Insert your Census API key here]")</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Here are the variable names and descriptions we are collecting:</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># DP05_0005E      Estimate!!SEX AND AGE!!Total population!!Under 5 years</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># S1701_C02_001E  Estimate!!Percent below poverty level!!Population for whom poverty status is determined"</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># S2301_C04_001E  Estimate!!Unemployment rate!!Population 16 years and over"</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># B03002_001E     Estimate!!Total:</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># B03002_003E     Estimate!!Total:!!Not Hispanic or Latino:!!White alone</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># B03002_004E     Estimate!!Total:!!Not Hispanic or Latino:!!Black or African American alone</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># B03002_005E     Estimate!!Total:!!Not Hispanic or Latino:!!American Indian and Alaska Native alone</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># B03002_006E     Estimate!!Total:!!Not Hispanic or Latino:!!Asian alone</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># B03002_007E     Estimate!!Total:!!Not Hispanic or Latino:!!Native Hawaiian and Other Pacific Islander alone</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># B03002_008E     Estimate!!Total:!!Not Hispanic or Latino:!!Some other race alone</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># B03002_009E     Estimate!!Total:!!Not Hispanic or Latino:!!Two or more races:</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># B03002_012E     Estimate!!Total:!!Hispanic or Latino:</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Population Under 5 ####</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>pop04 <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(<span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>                   <span class="at">variables =</span> <span class="st">"DP05_0005"</span>,</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>                   <span class="at">state =</span> <span class="st">"texas"</span>,</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>                   <span class="at">year =</span> <span class="dv">2023</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">pop04 =</span> estimate,</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">pop04_moe =</span> moe,</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">county =</span> GEOID) <span class="sc">%&gt;%</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(county, pop04, pop04_moe)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Poverty ####</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>poverty <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(<span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>                   <span class="at">variables =</span> <span class="st">"S1701_C03_001"</span>,</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>                   <span class="at">state =</span> <span class="st">"texas"</span>,</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>                   <span class="at">year =</span> <span class="dv">2023</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">poverty_rate =</span> estimate,</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">poverty_rate_moe =</span> moe,</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">county =</span> GEOID) <span class="sc">%&gt;%</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(county, poverty_rate, poverty_rate_moe)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="do">## Unemployment ####</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>unemploy <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(<span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>                    <span class="at">variables =</span> <span class="st">"S2301_C04_001"</span>,</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>                    <span class="at">state =</span> <span class="st">"texas"</span>,</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>                    <span class="at">year =</span> <span class="dv">2023</span>,) <span class="sc">%&gt;%</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">unemployment_rate =</span> estimate,</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>         <span class="at">unemployment_rate_moe =</span> moe,</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>         <span class="at">county =</span> GEOID) <span class="sc">%&gt;%</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(county, unemployment_rate, unemployment_rate_moe)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="do">## Race/Ethnicity ####</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>total_pop <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(<span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>                     <span class="at">variables =</span> <span class="st">"B03002_001"</span>,</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>                     <span class="at">state =</span> <span class="st">"texas"</span>,</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>                     <span class="at">year =</span> <span class="dv">2023</span>,) <span class="sc">%&gt;%</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">total_pop =</span> estimate,</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_pop_moe =</span> moe,</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>         <span class="at">county =</span> GEOID) <span class="sc">%&gt;%</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(county, total_pop, total_pop_moe)</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>white_pop <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(<span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>                     <span class="at">variables =</span> <span class="st">"B03002_003"</span>,</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>                     <span class="at">state =</span> <span class="st">"texas"</span>,</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>                     <span class="at">year =</span> <span class="dv">2023</span>,) <span class="sc">%&gt;%</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">white_pop =</span> estimate,</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>         <span class="at">white_pop_moe =</span> moe,</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>         <span class="at">county =</span> GEOID) <span class="sc">%&gt;%</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(county, white_pop, white_pop_moe)</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>black_pop <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(<span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>                     <span class="at">variables =</span> <span class="st">"B03002_004"</span>,</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>                     <span class="at">state =</span> <span class="st">"texas"</span>,</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>                     <span class="at">year =</span> <span class="dv">2023</span>,) <span class="sc">%&gt;%</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">black_pop =</span> estimate,</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>         <span class="at">black_pop_moe =</span> moe,</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>         <span class="at">county =</span> GEOID) <span class="sc">%&gt;%</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(county, black_pop, black_pop_moe)</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>ai_pop <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(<span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>                  <span class="at">variables =</span> <span class="st">"B03002_005"</span>,</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>                  <span class="at">state =</span> <span class="st">"texas"</span>,</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>                  <span class="at">year =</span> <span class="dv">2023</span>,) <span class="sc">%&gt;%</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">ai_pop =</span> estimate,</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>           <span class="at">ai_pop_moe =</span> moe,</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>           <span class="at">county =</span> GEOID) <span class="sc">%&gt;%</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(county, ai_pop, ai_pop_moe)</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>asian_pop <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(<span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>                     <span class="at">variables =</span> <span class="st">"B03002_006"</span>,</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>                     <span class="at">state =</span> <span class="st">"texas"</span>,</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>                     <span class="at">year =</span> <span class="dv">2023</span>,) <span class="sc">%&gt;%</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">asian_pop =</span> estimate,</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>         <span class="at">asian_pop_moe =</span> moe,</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>         <span class="at">county =</span> GEOID) <span class="sc">%&gt;%</span></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(county, asian_pop, asian_pop_moe)</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>nhpi_pop <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(<span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>                    <span class="at">variables =</span> <span class="st">"B03002_007"</span>,</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>                    <span class="at">state =</span> <span class="st">"texas"</span>,</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>                    <span class="at">year =</span> <span class="dv">2023</span>,) <span class="sc">%&gt;%</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">nhpi_pop =</span> estimate,</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>           <span class="at">nhpi_pop_moe =</span> moe,</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>           <span class="at">county =</span> GEOID) <span class="sc">%&gt;%</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(county, nhpi_pop, nhpi_pop_moe)</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>other_pop <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(<span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>                     <span class="at">variables =</span> <span class="st">"B03002_008"</span>,</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>                     <span class="at">state =</span> <span class="st">"texas"</span>,</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>                     <span class="at">year =</span> <span class="dv">2023</span>,) <span class="sc">%&gt;%</span></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">other_pop =</span> estimate,</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>         <span class="at">other_pop_moe =</span> moe,</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>         <span class="at">county =</span> GEOID) <span class="sc">%&gt;%</span></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(county, other_pop, other_pop_moe)</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>twoplus_pop <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(<span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>                       <span class="at">variables =</span> <span class="st">"B03002_009"</span>,</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>                       <span class="at">state =</span> <span class="st">"texas"</span>,</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>                       <span class="at">year =</span> <span class="dv">2023</span>,) <span class="sc">%&gt;%</span></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">twoplus_pop =</span> estimate,</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>         <span class="at">twoplus_pop_moe =</span> moe,</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>         <span class="at">county =</span> GEOID) <span class="sc">%&gt;%</span></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(county, twoplus_pop, twoplus_pop_moe)</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>hisp_pop <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(<span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>                    <span class="at">variables =</span> <span class="st">"B03002_012"</span>,</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>                    <span class="at">state =</span> <span class="st">"texas"</span>,</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>                    <span class="at">year =</span> <span class="dv">2023</span>,) <span class="sc">%&gt;%</span></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">hisp_pop =</span> estimate,</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>         <span class="at">hisp_pop_moe =</span> moe,</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>         <span class="at">county =</span> GEOID) <span class="sc">%&gt;%</span></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(county, hisp_pop, hisp_pop_moe)</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a><span class="co">#Join race/Ethnicity frames together</span></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>race_eth <span class="ot">&lt;-</span> total_pop <span class="sc">%&gt;%</span></span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(white_pop) <span class="sc">%&gt;%</span></span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(black_pop) <span class="sc">%&gt;%</span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ai_pop) <span class="sc">%&gt;%</span></span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(asian_pop) <span class="sc">%&gt;%</span></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(nhpi_pop) <span class="sc">%&gt;%</span></span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(other_pop) <span class="sc">%&gt;%</span></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(twoplus_pop) <span class="sc">%&gt;%</span></span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(hisp_pop)</span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a><span class="co"># Create percentages of each race/ethnicity</span></span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>race_eth <span class="ot">&lt;-</span> race_eth <span class="sc">%&gt;%</span></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">perc_white =</span> <span class="fu">round</span>((white_pop<span class="sc">/</span>total_pop)<span class="sc">*</span><span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">1</span>),</span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>         <span class="at">perc_black =</span> <span class="fu">round</span>((black_pop<span class="sc">/</span>total_pop)<span class="sc">*</span><span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">1</span>),</span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>         <span class="at">perc_ai =</span> <span class="fu">round</span>((ai_pop<span class="sc">/</span>total_pop)<span class="sc">*</span><span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">1</span>),</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>         <span class="at">perc_asian =</span> <span class="fu">round</span>((asian_pop<span class="sc">/</span>total_pop)<span class="sc">*</span><span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">1</span>),</span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>         <span class="at">perc_nhpi =</span> <span class="fu">round</span>((nhpi_pop<span class="sc">/</span>total_pop)<span class="sc">*</span><span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">1</span>),</span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>         <span class="at">perc_other =</span> <span class="fu">round</span>((other_pop<span class="sc">/</span>total_pop)<span class="sc">*</span><span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">1</span>),</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>         <span class="at">perc_twoplus =</span> <span class="fu">round</span>((twoplus_pop<span class="sc">/</span>total_pop)<span class="sc">*</span><span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">1</span>),</span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>         <span class="at">perc_hisp =</span> <span class="fu">round</span>((hisp_pop<span class="sc">/</span>total_pop)<span class="sc">*</span><span class="dv">100</span>, <span class="at">digits =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(county, total_pop, perc_white, perc_black, perc_ai, perc_asian, perc_nhpi, perc_other, perc_twoplus, perc_hisp)</span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a><span class="do">## Join to create census_demo ####</span></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>census_demo <span class="ot">&lt;-</span> pop04 <span class="sc">%&gt;%</span> </span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(race_eth) <span class="sc">%&gt;%</span></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(poverty) <span class="sc">%&gt;%</span></span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(unemploy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fips-codes" class="level2">
<h2 class="anchored" data-anchor-id="fips-codes">FIPS Codes</h2>
<p>Texas county FIPS Codes were retrieved from the <a href="https://www.census.gov/library/reference/code-lists/ansi.html#cou">US Census Bureau</a> website.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## FIPS Codes ####</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Read in FIPS codes so we can join frames (Downloaded from https://www.census.gov/library/reference/code-lists/ansi.html#cou)</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>fips <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">"/home/hilary/Documents/R/RExample/countyfips.txt"</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>, <span class="at">delim =</span> <span class="st">"|"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>fips <span class="ot">&lt;-</span> fips <span class="sc">%&gt;%</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">county=</span><span class="fu">paste</span>(STATEFP, COUNTYFP, <span class="at">sep =</span> <span class="st">""</span>)) <span class="sc">%&gt;%</span> <span class="do">## Combine STATEFP and COUNTYFP for full FIPS code</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">county_name =</span> COUNTYNAME) <span class="sc">%&gt;%</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(county, county_name) <span class="sc">%&gt;%</span> </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">county_name =</span> <span class="fu">str_to_upper</span>(county_name)) <span class="do">## To Upper case</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="do">##Join census demo with FIPS codes</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>census_demo <span class="ot">&lt;-</span> census_demo <span class="sc">%&gt;%</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(fips)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="urbanrural-status" class="level2">
<h2 class="anchored" data-anchor-id="urbanrural-status">Urban/Rural Status</h2>
<p>Rural Urban Continuum codes were retrieved from the <a href="https://www.ers.usda.gov/data-products/rural-urban-continuum-codes">USDA Economic Research Service</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Urban and Rural status ####</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Read in urban/rural county (Downloaded from https://www.ers.usda.gov/data-products/rural-urban-continuum-codes)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>urban <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"/home/hilary/Documents/R/RExample/Ruralurbancontinuumcodes2023.xlsx"</span>) </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>urban <span class="ot">&lt;-</span> urban <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(State <span class="sc">==</span> <span class="st">"TX"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">urban_rural =</span> <span class="fu">case_when</span>(RUCC_2023 <span class="sc">&lt;</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Urban"</span>, <span class="do">## &lt; 4 is considered rural</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                                 RUCC_2023 <span class="sc">&gt;=</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Rural"</span>)) <span class="sc">%&gt;%</span> <span class="do">## &gt;= 4 is considered urban</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">county =</span> FIPS) <span class="sc">%&gt;%</span> <span class="do">## Rename to FIPS for joining</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(county, urban_rural)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Join census demo with urban/rural info</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>census_demo <span class="ot">&lt;-</span> census_demo <span class="sc">%&gt;%</span> </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(urban)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="texas-child-care-data" class="level2">
<h2 class="anchored" data-anchor-id="texas-child-care-data">Texas Child Care Data</h2>
<p>The Texas Child Care Data was retrieved from the <a href="https://data.texas.gov/See-Category-Tile/HHSC-CCL-Daycare-and-Residential-Operations-Data/bc5r-88dy/about_data">Texas Open Data Portal</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Child Care Data ####</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Open Child Care Data #### </span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Downloaded from https://data.texas.gov/See-Category-Tile/HHSC-CCL-Daycare-and-Residential-Operations-Data/bc5r-88dy/about_data</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>cc <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/home/hilary/Documents/R/RExample/HHSC_CCL_Daycare_and_Residential_Operations_Data_20250406.csv"</span>) </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Prepare for joining with census_demo. Requires County name to be uppercase without COUNTY word</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>cc <span class="ot">&lt;-</span> cc <span class="sc">%&gt;%</span> </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">county =</span> <span class="st">"COUNTY"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">county_name=</span><span class="fu">paste</span>(COUNTY, county, <span class="at">sep =</span> <span class="st">" "</span>)) <span class="sc">%&gt;%</span> <span class="do">## Add " COUNTY" to end of county names for clean joining</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">case_when</span>(county_name <span class="sc">==</span> <span class="st">"DEAFSMITH COUNTY"</span> <span class="sc">~</span> <span class="st">"DEAF SMITH COUNTY"</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>                   <span class="cn">TRUE</span> <span class="sc">~</span> county_name )) <span class="sc">%&gt;%</span> </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>county)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="do">##Join census_demo with child care data</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> census_demo <span class="sc">%&gt;%</span> </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a> <span class="fu">full_join</span>(cc)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Clean up Child Care data ####</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Remove non-traditional child care programs and combine registered and licensed child care homes as "Home"s</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(OPERATION_TYPE <span class="sc">!=</span> <span class="st">"Child Placing Agency"</span> <span class="sc">&amp;</span> OPERATION_TYPE <span class="sc">!=</span> <span class="st">"General Residential Operation"</span> <span class="sc">&amp;</span> OPERATION_TYPE <span class="sc">!=</span> <span class="st">"Listed Family Home"</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( <span class="fu">is.na</span>(CARE_TYPE) <span class="sc">|</span> (CARE_TYPE <span class="sc">!=</span> <span class="st">"Before/After School Program"</span> <span class="sc">&amp;</span> CARE_TYPE <span class="sc">!=</span> <span class="st">"School Age Program"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TEMPORARILY_CLOSED <span class="sc">!=</span> <span class="st">"YES"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">operation_type =</span> OPERATION_TYPE) <span class="sc">%&gt;%</span> </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prov_type =</span> <span class="fu">case_when</span>(operation_type <span class="sc">==</span> <span class="st">"Licensed Center"</span> <span class="sc">~</span> <span class="st">"Center"</span>,</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>                               operation_type <span class="sc">==</span> <span class="st">"Registered Child-Care Home"</span> <span class="sc">~</span> <span class="st">"Home"</span>,</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>                               operation_type <span class="sc">==</span> <span class="st">"Licensed Child-Care Home"</span> <span class="sc">~</span> <span class="st">"Home"</span>)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="do">## More cleaning. </span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>ccset <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(county, perc_white, perc_black, perc_hisp, poverty_rate, unemployment_rate, county_name, OPERATION_ID, OPERATION_NAME, LOCATION_ADDRESS, ACCEPTS_CHILD_CARE_SUBSIDIES, HOURS_OF_OPERATION, DAYS_OF_OPERATION, TOTAL_CAPACITY, prov_type, total_pop, urban_rural, pop04) <span class="sc">%&gt;%</span> <span class="do">##Trim data set to variables we want</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(tolower, <span class="at">.cols =</span> <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> <span class="do">## Rename to lowercase for easier typing </span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prov_type =</span> <span class="fu">as.factor</span>(prov_type), <span class="do">## Convert to factor</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">county_name =</span> <span class="fu">as.factor</span>(county_name), <span class="do">## Convert to factor</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">days_of_operation =</span> <span class="fu">as.factor</span>(days_of_operation) <span class="do">## Convert to factor</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hours_open =</span> <span class="fu">str_split_i</span>(hours_of_operation, <span class="st">"-"</span>, <span class="dv">1</span>), <span class="do">## Isolate Opening Time</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">hours_close =</span> <span class="fu">str_split_i</span>(hours_of_operation, <span class="st">"-"</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> <span class="do">## Isolate Closing time</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hours_close_hr =</span> <span class="fu">as.numeric</span>(<span class="fu">str_split_i</span>(hours_close, <span class="st">":"</span>, <span class="dv">1</span>)), <span class="do">## Isolate closing hour</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">hours_close_min =</span> <span class="fu">str_split_i</span>(hours_close, <span class="st">":"</span>, <span class="dv">2</span>), <span class="do">## Isolate closing minute = AM PM</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>         <span class="at">hours_close_aft =</span> <span class="fu">str_split_i</span>(hours_close, <span class="st">" "</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> <span class="do">## Isolate AM vs. PM</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hours_close_min =</span> <span class="fu">as.numeric</span>(<span class="fu">str_split_i</span>(hours_close_min, <span class="st">" "</span>, <span class="dv">1</span>))) <span class="sc">%&gt;%</span> <span class="do">## Isolate closing minute</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hours_close_hrplus12 =</span> hours_close_hr <span class="sc">+</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span> <span class="do">## Convert closing hour to 24-hour time (PM)</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hours_close_hr24 =</span> <span class="fu">case_when</span>(hours_close_aft <span class="sc">==</span> <span class="st">"PM"</span> <span class="sc">~</span> hours_close_hrplus12, <span class="do">## Use 24-hour PM time if PM</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>                                      hours_close_aft <span class="sc">==</span> <span class="st">"AM"</span> <span class="sc">~</span> hours_close_hr) <span class="do">## Use 24-hour AM time if AM</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span> </span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hours_close_hr24 =</span> (hours_close_hr24<span class="sc">*</span><span class="dv">100</span>)<span class="sc">+</span>hours_close_min) <span class="sc">%&gt;%</span> <span class="do">## Multiply by 100 so 12 hours becomes 1200</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(hours_close_hr, hours_close_min, hours_close_hrplus12, hours_close_aft)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">open_aft_6 =</span> <span class="fu">case_when</span>(hours_close_hr24 <span class="sc">&gt;</span> <span class="dv">1800</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="do">## Open_aft_6 = 1 if open past 6 pm</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>                                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> <span class="do">## Otherwise 0</span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">open_wknd =</span> <span class="fu">case_when</span>(<span class="fu">str_detect</span>(days_of_operation, <span class="st">"Sat"</span>) <span class="sc">~</span> <span class="dv">1</span>, <span class="do">## Open weekend = 1 if open Saturday</span></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">str_detect</span>(days_of_operation, <span class="st">"Sun"</span>) <span class="sc">~</span> <span class="dv">1</span>, <span class="do">## or Sunday</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>                               <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">urban_rural =</span> <span class="fu">as.factor</span>(urban_rural)) <span class="sc">%&gt;%</span> <span class="do">## Convert to factor</span></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_cap_home =</span> <span class="fu">case_when</span>(prov_type <span class="sc">==</span> <span class="st">"Home"</span> <span class="sc">~</span> total_capacity, <span class="do">## Total capacity just for Homes</span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>                                    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>),</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_cap_center =</span>  <span class="fu">case_when</span>(prov_type <span class="sc">==</span> <span class="st">"Center"</span> <span class="sc">~</span> total_capacity, <span class="do">## Total capacity just for Centers</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>                                       <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="collapse-to-county-level-values" class="level2">
<h2 class="anchored" data-anchor-id="collapse-to-county-level-values">Collapse to County-Level Values</h2>
<p>Now I am going to use our clean and complete data set to collapse values to the county-level, so that we end with a data set containing one record per Texas County.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Collapse to county-level values ####</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>sum <span class="ot">&lt;-</span> ccset <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(county_name) <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">county_cap_sum =</span> <span class="fu">sum</span>(total_capacity, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">county_cap_mean =</span> <span class="fu">mean</span>(total_capacity, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">county_cap_n =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>((total_capacity))), </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">county_home_n =</span> <span class="fu">sum</span>(prov_type <span class="sc">==</span> <span class="st">"Home"</span>),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">county_center_n =</span> <span class="fu">sum</span>(prov_type <span class="sc">==</span> <span class="st">"Center"</span>),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">perc_home =</span> <span class="fu">mean</span>(prov_type <span class="sc">==</span> <span class="st">"Home"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">perc_white =</span> <span class="fu">mean</span>(perc_white, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">perc_black =</span> <span class="fu">mean</span>(perc_black, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">perc_hisp =</span> <span class="fu">mean</span>(perc_hisp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_pop =</span> <span class="fu">mean</span>(total_pop, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">unemployment_rate =</span> <span class="fu">mean</span>(unemployment_rate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">poverty_rate =</span> <span class="fu">mean</span>(poverty_rate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_pop =</span> <span class="fu">mean</span>(total_pop, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">open_wknd =</span> <span class="fu">sum</span>(open_wknd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">open_aft_6 =</span> <span class="fu">sum</span>(open_aft_6, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">urban_rural =</span> <span class="fu">fmode</span>(urban_rural, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="do">## Keeps most common value... which is same across county</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">county_cap_home_sum =</span> <span class="fu">sum</span>(total_cap_home, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">county_cap_center_sum =</span> <span class="fu">sum</span>(total_cap_center, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">pop04 =</span> <span class="fu">mean</span>(pop04)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">perc_cap_home =</span> (county_cap_home_sum<span class="sc">/</span>county_cap_sum)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">pop_rank =</span> <span class="fu">rank</span>(total_pop),</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">perc_pop04_cap =</span> (county_cap_sum<span class="sc">/</span>pop04)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_pop1000 =</span> total_pop<span class="sc">/</span><span class="dv">1000</span>,</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">perc_home =</span> perc_home<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">perc_pop04_cap =</span> <span class="fu">case_when</span>(perc_pop04_cap <span class="sc">&gt;</span> <span class="dv">100</span> <span class="sc">~</span> <span class="dv">100</span>,</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>                                    <span class="cn">TRUE</span> <span class="sc">~</span> perc_pop04_cap)) <span class="do">## Cap at 100%. Note that very few child care providers operate at their full licensed capacity... In fact we estimate that on average they operate at 70% capacity. Just because they have the physical space for 100 kids doesn't mean they have any intention to care for 100 kids or are staffed to do so. </span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="do">## Create a subsets of data that I may want to use</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>sum_50 <span class="ot">&lt;-</span> sum <span class="sc">%&gt;%</span> <span class="do">## 50 most populated counties</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pop_rank <span class="sc">&gt;</span> <span class="dv">189</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(total_pop))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>At this point, the data set looks like this:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 241 × 23
   county_name      county_cap_sum county_cap_mean county_cap_n county_home_n
   &lt;fct&gt;                     &lt;dbl&gt;           &lt;dbl&gt;        &lt;int&gt;         &lt;int&gt;
 1 ANDERSON COUNTY            1367            97.6           14             1
 2 ANDREWS COUNTY              698           116.             6             1
 3 ANGELINA COUNTY            3924           103.            38             2
 4 ARANSAS COUNTY              550            78.6            7             2
 5 ARCHER COUNTY               256            51.2            5             0
 6 ARMSTRONG COUNTY             51            25.5            2             1
 7 ATASCOSA COUNTY            1111            69.4           16             3
 8 AUSTIN COUNTY              1071            76.5           14             1
 9 BAILEY COUNTY               186            46.5            4             0
10 BANDERA COUNTY              414           104.             4             0
# ℹ 231 more rows
# ℹ 18 more variables: county_center_n &lt;int&gt;, perc_home &lt;dbl&gt;,
#   perc_white &lt;dbl&gt;, perc_black &lt;dbl&gt;, perc_hisp &lt;dbl&gt;, total_pop &lt;dbl&gt;,
#   unemployment_rate &lt;dbl&gt;, poverty_rate &lt;dbl&gt;, open_wknd &lt;dbl&gt;,
#   open_aft_6 &lt;dbl&gt;, urban_rural &lt;fct&gt;, county_cap_home_sum &lt;dbl&gt;,
#   county_cap_center_sum &lt;dbl&gt;, pop04 &lt;dbl&gt;, perc_cap_home &lt;dbl&gt;,
#   pop_rank &lt;dbl&gt;, perc_pop04_cap &lt;dbl&gt;, total_pop1000 &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="analysis" class="level1">
<h1>Analysis</h1>
<section id="correlations" class="level2">
<h2 class="anchored" data-anchor-id="correlations">Correlations</h2>
<p>We can start by looking at some basic correlations between some of the numeric variables in our data set. We will start by testing the correlations between population size, number of child care providers, number of child care slots, proportion of the child care providers that are home-based providers, and the proportion of the population that belong to a few select race/ethnicity groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Test Correlations</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> sum <span class="sc">%&gt;%</span> <span class="do">## Select a few continuous/percentage variables </span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(total_pop, county_cap_n, county_cap_sum, perc_home, perc_white, perc_black, perc_hisp) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(total_pop)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  correlation<span class="sc">::</span><span class="fu">correlation</span>(<span class="at">include_factors =</span> <span class="cn">TRUE</span>, <span class="at">method =</span> <span class="st">"auto"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Parameter1, Parameter2, r, df_error, p, Method, n_Obs)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(cor, <span class="at">format =</span> <span class="st">"html"</span>, <span class="at">digits=</span><span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Parameter1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Parameter2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">r</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df_error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Method</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n_Obs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">total_pop</td>
<td style="text-align: left;">county_cap_n</td>
<td style="text-align: right;">0.992</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">239</td>
</tr>
<tr class="even">
<td style="text-align: left;">total_pop</td>
<td style="text-align: left;">county_cap_sum</td>
<td style="text-align: right;">0.988</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">239</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_pop</td>
<td style="text-align: left;">perc_home</td>
<td style="text-align: right;">0.096</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">239</td>
</tr>
<tr class="even">
<td style="text-align: left;">total_pop</td>
<td style="text-align: left;">perc_white</td>
<td style="text-align: right;">-0.204</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">0.018</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">239</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total_pop</td>
<td style="text-align: left;">perc_black</td>
<td style="text-align: right;">0.271</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">239</td>
</tr>
<tr class="even">
<td style="text-align: left;">total_pop</td>
<td style="text-align: left;">perc_hisp</td>
<td style="text-align: right;">0.056</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">239</td>
</tr>
<tr class="odd">
<td style="text-align: left;">county_cap_n</td>
<td style="text-align: left;">county_cap_sum</td>
<td style="text-align: right;">0.993</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">239</td>
</tr>
<tr class="even">
<td style="text-align: left;">county_cap_n</td>
<td style="text-align: left;">perc_home</td>
<td style="text-align: right;">0.101</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">239</td>
</tr>
<tr class="odd">
<td style="text-align: left;">county_cap_n</td>
<td style="text-align: left;">perc_white</td>
<td style="text-align: right;">-0.214</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">0.012</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">239</td>
</tr>
<tr class="even">
<td style="text-align: left;">county_cap_n</td>
<td style="text-align: left;">perc_black</td>
<td style="text-align: right;">0.262</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">239</td>
</tr>
<tr class="odd">
<td style="text-align: left;">county_cap_n</td>
<td style="text-align: left;">perc_hisp</td>
<td style="text-align: right;">0.065</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">239</td>
</tr>
<tr class="even">
<td style="text-align: left;">county_cap_sum</td>
<td style="text-align: left;">perc_home</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">239</td>
</tr>
<tr class="odd">
<td style="text-align: left;">county_cap_sum</td>
<td style="text-align: left;">perc_white</td>
<td style="text-align: right;">-0.195</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">0.027</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">239</td>
</tr>
<tr class="even">
<td style="text-align: left;">county_cap_sum</td>
<td style="text-align: left;">perc_black</td>
<td style="text-align: right;">0.276</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">239</td>
</tr>
<tr class="odd">
<td style="text-align: left;">county_cap_sum</td>
<td style="text-align: left;">perc_hisp</td>
<td style="text-align: right;">0.037</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">239</td>
</tr>
<tr class="even">
<td style="text-align: left;">perc_home</td>
<td style="text-align: left;">perc_white</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">239</td>
</tr>
<tr class="odd">
<td style="text-align: left;">perc_home</td>
<td style="text-align: left;">perc_black</td>
<td style="text-align: right;">0.083</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">239</td>
</tr>
<tr class="even">
<td style="text-align: left;">perc_home</td>
<td style="text-align: left;">perc_hisp</td>
<td style="text-align: right;">-0.058</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">239</td>
</tr>
<tr class="odd">
<td style="text-align: left;">perc_white</td>
<td style="text-align: left;">perc_black</td>
<td style="text-align: right;">0.060</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">239</td>
</tr>
<tr class="even">
<td style="text-align: left;">perc_white</td>
<td style="text-align: left;">perc_hisp</td>
<td style="text-align: right;">-0.938</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">239</td>
</tr>
<tr class="odd">
<td style="text-align: left;">perc_black</td>
<td style="text-align: left;">perc_hisp</td>
<td style="text-align: right;">-0.380</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">Pearson correlation</td>
<td style="text-align: right;">239</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Unsurprisingly, a county’s total population size (<code>total_pop</code>) is highly correlated with the total number of child care providers in the county (<code>county_cap_n</code>; <em>r</em> = 0.992, <em>p</em>&lt; 0.001) and total number child care slots in the county (<code>county_cap_sum</code>; <em>r</em> = 0.988, <em>p</em>&lt; 0.001). As population increases, child care supply increases.</p>
<p>Next we see that as a county’s total population increases, the percentage of White residents decreases (<em>r</em> = -0.204, <em>p</em>= 0.018) and the percentage of Black residents increases (<em>r</em> = 0.271, <em>p</em> &lt; 0.001). However, a county’s population size is not significantly correlated with the percentage of Hispanic residents (<em>r</em> = 0.065, <em>p</em>= 1.000).</p>
<p>We can see below that even in urban Texas counties, a small percentage of the population identifies as Black.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SampleQuartoDoe_files/figure-html/Graph%201-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="regression" class="level2">
<h2 class="anchored" data-anchor-id="regression">Regression</h2>
<p>Texas is a very large state, with 254 counties in all. Of these, two-thirds are considered rural counties, some of which have no licensed or register child child care providers that meet our inclusion criteria for the sample.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Texas Counties: Urban/Rural Status</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Count</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Rural</td>
<td style="text-align: right;">168</td>
<td style="text-align: right;">66.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">Urban</td>
<td style="text-align: right;">86</td>
<td style="text-align: right;">33.86</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>As suggested from the bar plot below, much of the Texas population is concentrated in a few counties with large cities.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SampleQuartoDoe_files/figure-html/Bar%20plot1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Within these counties, the total supply of child care slots generally aligns with the population of the county. However, it does appear that counties with a higher poverty rate <em>may</em> have slightly lower total child care capacity in comparison to the population size.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SampleQuartoDoe_files/figure-html/Bar%20plot2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This raises the question of whether child care coverage may be lower in higher poverty areas, which we can test with linear regression. Next, I am going to create a function and use it to output regression results. I realize this function does not save much effort, but I wanted to demonstrate my ability to create and use my own function.</p>
<p>For the following analysis, I am using the variable perc_pop04_cap, which is meant to be a proxy child care coverage/availability in the county. I calculated perc_pop04_cap as <strong>(total number licensed capacity child care slots)/(Total population of children under 5 years) X 100</strong>, and top-coded this to 100%. It is important to note that most child care providers never operate at their full licensed capacity, which is determined based on physical space available to the operation. From previous research, we estimate that on average, Texas child care providers operate at approximately 70% of their total licensed capacity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Create functions for simple Regression output </span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>regout <span class="ot">&lt;-</span> <span class="cf">function</span>(data, formula, <span class="at">digits =</span> <span class="dv">3</span>){</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  mod <span class="ot">&lt;&lt;-</span> <span class="fu">lm</span>(formula, <span class="at">data =</span> data) <span class="do">## Run lm model</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="fu">tidy</span>(mod), <span class="at">digits =</span> digits, <span class="at">caption =</span> {{formula}}) <span class="do">## kable output</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>} </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>perc_pop04_cap ~ poverty_rate</caption>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">47.098</td>
<td style="text-align: right;">3.252</td>
<td style="text-align: right;">14.484</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">poverty_rate</td>
<td style="text-align: right;">-0.204</td>
<td style="text-align: right;">0.200</td>
<td style="text-align: right;">-1.017</td>
<td style="text-align: right;">0.31</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The results indicate that poverty rate does <em>not</em> significantly predict child care availability in the full population of Texas counties. However, what we looked at before was the highest populated counties, which tend to surround urban areas. Let’s look at a graph showing how the association between child care availability and population differs by urban/rural status.</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SampleQuartoDoe_files/figure-html/Analysis%20reg2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can now test whether adding a county’s urban/rural designation and/or an interaction between urban/rural and poverty rate improve model fit.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>perc_pop04_cap ~ poverty_rate + urban_rural</caption>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">43.408</td>
<td style="text-align: right;">3.557</td>
<td style="text-align: right;">12.202</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">poverty_rate</td>
<td style="text-align: right;">-0.109</td>
<td style="text-align: right;">0.202</td>
<td style="text-align: right;">-0.542</td>
<td style="text-align: right;">0.588</td>
</tr>
<tr class="odd">
<td style="text-align: left;">urban_ruralUrban</td>
<td style="text-align: right;">6.491</td>
<td style="text-align: right;">2.665</td>
<td style="text-align: right;">2.436</td>
<td style="text-align: right;">0.016</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>perc_pop04_cap ~ poverty_rate + urban_rural + poverty_rate:urban_rural</caption>
<colgroup>
<col style="width: 44%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">39.871</td>
<td style="text-align: right;">3.880</td>
<td style="text-align: right;">10.276</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">poverty_rate</td>
<td style="text-align: right;">0.114</td>
<td style="text-align: right;">0.225</td>
<td style="text-align: right;">0.506</td>
<td style="text-align: right;">0.613</td>
</tr>
<tr class="odd">
<td style="text-align: left;">urban_ruralUrban</td>
<td style="text-align: right;">21.558</td>
<td style="text-align: right;">7.362</td>
<td style="text-align: right;">2.928</td>
<td style="text-align: right;">0.004</td>
</tr>
<tr class="even">
<td style="text-align: left;">poverty_rate:urban_ruralUrban</td>
<td style="text-align: right;">-1.089</td>
<td style="text-align: right;">0.497</td>
<td style="text-align: right;">-2.193</td>
<td style="text-align: right;">0.029</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>You can see from the likelihood ratio test below that adding an interaction between poverty rate and urban/rural status significantly improves model fit (<em>p</em> &lt; 0.001). You can also see from the results above that interaction itself is significant (<em>p</em> = 0.029). Although poverty rate does not predict child care coverage in rural counties, in urban counties an increase in poverty rate by 1 percent is associated with a 1.09 percentage point decrease in child care coverage.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compare models</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>cap_pov_sum2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(perc_pop04_cap <span class="sc">~</span> poverty_rate <span class="sc">+</span> urban_rural, <span class="at">data=</span> sum)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>cap_pov_sum3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(perc_pop04_cap <span class="sc">~</span> poverty_rate <span class="sc">+</span> poverty_rate<span class="sc">:</span>urban_rural, <span class="at">data=</span> sum)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(cap_pov_sum2, cap_pov_sum3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood ratio test

Model 1: perc_pop04_cap ~ poverty_rate + urban_rural
Model 2: perc_pop04_cap ~ poverty_rate + poverty_rate:urban_rural
  #Df  LogLik Df  Chisq Pr(&gt;Chisq)    
1   4 -1045.2                         
2   4 -1047.0  0 3.7242  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>As you can see, the poverty rate within urban Texas counties varies considerably.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SampleQuartoDoe_files/figure-html/bar-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>Results indicate, on average, urban Texas counties with higher poverty rates may have have lower overall child care availability for their early childhood population. Although licensed capacity is only a rough proxy of child care supply, and the population of children under 5 years is a rough proxy for child care demand, the results suggest the presence of inequity of child care coverage in urban Texas counties.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>